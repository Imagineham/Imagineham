%---------change this every homework
% place your email id between the braces so that your homework has a name
\def\yourname{hamlet}
% -----------------------------------------------------
\def\homework{1} % 0 for solution, 1 for problem-set only
\def\duedate{Tuesday January 19 at 12 noon}
\def\duelocation{via \href{https://www.gradescope.com/courses/225474}{gradescope}}
\def\hnumber{1}
\def\prof{Andrew Drucker, Lorenzo Orecchia}
\def\course{\href{https://canvas.uchicago.edu/courses/33273}{CMSC 27200 - Winter 2021}}
%-------------------------------------

\documentclass[10pt]{article}
\usepackage[colorlinks,urlcolor=blue]{hyperref}
\usepackage[osf]{mathpazo}
\usepackage{amsmath,amsfonts,graphicx}
\usepackage{latexsym}
\usepackage{subfig}
\usepackage{algpseudocode}
\usepackage{enumitem}
\usepackage{algorithm}
\usepackage{listings}
%\usepackage[top=1in,bottom=1.4in,left=1.5in,right=1.5in,centering]{geometry}
\usepackage{fullpage}
\usepackage{color}
\definecolor{mdb}{rgb}{0.3,0.02,0.02} 
\definecolor{cit}{rgb}{0.05,0.2,0.45} 
%\pagestyle{myheadings}
\markboth{\yourname}{\yourname}

\thispagestyle{empty}

\newenvironment{proof}{\par\noindent{\it Proof.}\hspace*{1em}}{$\Box$\bigskip}
\newcommand{\qed}{$\Box$}
\newcommand{\alg}[1]{\mathsf{#1}}
\newcommand{\handout}{
   \renewcommand{\thepage}{H\hnumber-\arabic{page}}
   \noindent
   \begin{center}
      \vbox{
    \hbox to \columnwidth {\sc{\course} --- \prof \hfill}
    \vspace{-2mm}
    \hbox to \columnwidth {\sc due \MakeLowercase{\duedate} \duelocation\hfill {\Huge\color{mdb}H\hnumber.\yourname}}
      }
   \end{center}
   \vspace*{2mm}
}
\newcommand{\solution}[1]{\medskip\noindent{\color{cit}\textbf{Solution:} #1}}

\newcommand{\bit}[1]{\{0,1\}^{ #1 }}
%\dontprintsemicolon
%\linesnumbered
\newtheorem{problem}{\sc\color{cit}problem}
\newtheorem{lemma}{Lemma}
\newtheorem{theorem}{Theorem}
\newtheorem{definition}{Definition}
\newtheorem{claim}{Claim}


\begin{document}
\handout
\begin{itemize}
\item The assignment is due at Gradescope on Tuesday, January 19 at 12:00 noon. 

\item You can either type your homework using LaTex or scan your handwritten work. We will provide a LaTex template for each homework. If you writing by hand, please fill in the solutions in this template, inserting additional sheets as necessary. This will facilitate the grading.

\item You are permitted to study with up to 2 other students in the class and discuss the problems; however, {\em you must write up your own solutions, in your own words}. Do not submit anything you cannot explain. If you do collaborate with any of the other students on any problem, please do list all your collaborators in your submission for each problem. 

\item Similarly, please list any other source you have used for each problem, including other textbooks or websites. {\it Consulting problem solutions on the web is not allowed.}


\item {\em Show your work.} Answers without justification will be given little credit.
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\begin{problem}[25 points]
 Answer the questions below using the following preference lists:

 \begin{enumerate}
 \item[] Group $A$'s preference lists (from most preferred to least preferred):
 \item[$a_1$:] $b_1$, $b_4$, $b_3$, $b_2$
 \item[$a_2$:] $b_4$, $b_3$, $b_1$, $b_2$
 \item[$a_3$:] $b_1$, $b_2$, $b_4$, $b_3$
 \item[$a_4$:] $b_3$, $b_1$, $b_2$, $b_4$
 \end{enumerate}

 \begin{enumerate}
 \item[]  Group $B$'s preference lists (from most preferred to least preferred):
 \item[$b_1$:] $a_4$, $a_2$, $a_3$, $a_1$
 \item[$b_2$:] $a_1$, $a_4$, $a_2$, $a_3$
 \item[$b_3$:] $a_3$, $a_1$, $a_4$, $a_2$
 \item[$b_4$:] $a_4$, $a_3$, $a_1$, $a_2$
 \end{enumerate}

\begin{enumerate}
    \item[(a)] Run the Gale-Shapley algorithm with group $A$ making the offers to obtain a stable matching. For your answer (and for your answer to part b as well), at each step please give the offer that is made and whether or not this offer is accepted. You should also give the final matching you obtain.
    \item[(b)] Now run the Gale-Shapley algorithm with group $B$ making the offers to obtain another stable matching. Which people are happier in this new stable matching (compared to the stable matching found in part a)?
    \item[(c)] What other stable matching(s) are there, if any? Note: For full credit you should show that you have indeed found all of the possible stable matchings.
    \end{enumerate}
\end{problem}

\solution{

Part A:\\

  \begin{tabular}{c|c|c}

  OFFER       &         ACCEPT?   &COMMENTS \\ 
  $a_1$ to $b_1$      &   Yes        &$a_1$, $b_1$ ENGAGED \\
  $a_2$ to $b_4$      &   Yes        &$a_2$, $b_4$ ENGAGED\\
  $a_3$ to $b_1$      &   Yes        &$a_3$, $b_1$ ENGAGED, $a_1$ is now FREE\\
  $a_1$ to $b_4$      &   Yes        &$a_1$, $b_4$ ENGAGED, $a_2$ is now FREE\\
  $a_2$ to $b_3$     &   Yes        &$a_2$, $b_3$ ENGAGED\\
  $a_4$ to $b_3$      &   Yes        &$a_4$, $b_3$ ENGAGED, $a_2$ is now FREE \\
   $a_2$ to $b_1$      &   Yes       &$a_2$, $b_1$ ENGAGED, $a_3$ is now FREE\\
  $a_3$ to $b_2$      &   Yes       &$a_3$, $b_2$ ENGAGED  %at this point everyone is ENGAGED and in stable matchings    
  \end{tabular}
  \\
  \\
  FINAL PAIRINGS:
  ($a_1$, $b_4$)
  ($a_2$, $b_1$)
  ($a_3$, $b_2$)
  ($a_4$, $b_3$)


\newpage

Part B:\\

  \begin{tabular}{c|c|c}

 OFFER               &   ACCEPT?    &      COMMENTS \\
 $b_1$ to $a_4$      &   Yes        &   $b_1$, $a_4$ ENGAGED \\
 $b_2$ to $a_1$      &   Yes        &   $b_2$, $a_1$ ENGAGED\\
  $b_3$ to $a_3$      &   Yes       &   $b_3$, $a_3$ ENGAGED\\
 $b_4$ to $a_4$      &   No         &   $b_4$ is still FREE\\
 $b_4$ to $a_3$      &   Yes        &   $b_4$, $a_3$ ENGAGED, $b_3$ is now FREE\\
 $b_3$ to $a_1$      &   Yes       &   $b_3$, $a_1$ ENGAGED, $b_2$ is now FREE \\
 $b_2$ to $a_4$      &   No         &   $b_2$ is still FREE\\
  $b_2$ to $a_2$      &   Yes       &   $b_2$, $a_2$ ENGAGED  %at this point everyone is ENGAGED and in stable matchings    

 \end{tabular}
  \\
  \\
  FINAL PAIRINGS:
  ($b_1$, $a_4$)
  ($b_2$, $a_2$)
  ($b_3$, $a_1$)
  ($b_4$, $a_3$) 
  \\

  HAPPIER: $b_1$, $b_2$, $b_3$, $b_4$ (they were able to choose). \\

Part C:
  The pairings found in A and the pairings found in B are all the stable pairings. This can be proved using the fact 
  that the G-S algorithm finds proposer's best valid partner and proposee's worse possible partner. Thus when looking 
  at any (a,b) all the stable matching that can be found lie in between the overlap. Let's use $a_1$ as an example. 
  In the answer to Part A we found that since a did the proposing, the best valid partner is $b_4$, which was second on $a_1$'s ranking.
  In the answer to Part B, we found that when a was ebing proposed to, the worst valid partner is $b_3$, which was third on $a_1$'s list. 
  Since $b_4$ was the best, and $b_3$ was the worst then any rankings in between would be possible stable macthings. However, since 
  there existed no b's ranked in between $b_4$ and $b_3$, ($a_1$, $b_4$) and ($a_1$, $b_3$) are the only stable matching for $a_1$. 
  This proof holds for all a's and b's, where the stable matchings already found are in fact all the stable matchings that exist for this 
  set of preferences.  

  \begin{enumerate}
    \item[] Group $A$'s preference lists (best and worst):
    \item[$a_1$:] [$b_4$ BEST, $b_3$ WORST]
    \item[$a_2$:] [$b_1$ BEST, $b_2$ WORST]
    \item[$a_3$:] [$b_2$ BEST, $b_4$ WORST]
    \item[$a_4$:] [$b_3$ BEST, $b_1$ WORST]
  \end{enumerate}
   
  \begin{enumerate}
    \item[]  Group $B$'s preference lists (best and worst):
    \item[$b_1$:] [$a_4$ BEST, $a_2$ WORST]
    \item[$b_2$:] [$a_2$ BEST, $a_3$ WORST]
    \item[$b_3$:] [$a_1$ BEST, $a_4$ WORST]
    \item[$b_4$:] [$a_3$ BEST, $a_1$ WORST]
  \end{enumerate}

}

\newpage
\medskip\noindent{\color{cit} Extra Space for your solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\begin{problem}[30 points]
Solve exercise 8 in Chapter 1 in the Kleinberg-Tardos textbook.
\end{problem}
\solution{

\textit{Give a proof that, for any set of preference lists, switching the
order of a pair on the list cannot improve a womanâ€™s partner in the GaleShapley algorithm} 

\paragraph{Proof} For this proof let's assume we have three men, $m$, $m'$, and $m''$ and three women, $w$, $w'$, $w''$. 
Let's also assume w: $m'' > m > m'$ but switched the order of $m$ and $m'$ so that the G-S Algorithm works with 
w: $m'' > m' > m$. Our goal for this proof is to show that while w always prefers $m''$, dishonestly switching the order of 
lesser preferences does not benefit the person. We will work backwards. 

\paragraph{}For $w$ to be engaged with $m''$ there are two scenarios: either both are free and $m''$ proposes to $w$ or $w$ is already engaged, $m''$ is free, and 
$m''$ has not already proposed to w. In the first scenario, the order of lesser preferences for $w$ does not impact her happiness because $w$ would be 
engaged to her top choice and according to statement 1.1 of the KT textbook, a woman's partner will never get worse. In fact, in any case where $m''$ propsoes $w$ will be happiest.
Whether they are engaged to $m$ or $m'$, a proposal from $m''$ will result in ($m''$,$w$). In the case $m''$ never porposes, if $w$ is engaged to $m$ and $m'$ proposes
according to the G-S algorithm, $w$ will leave and pair with $m'$. To the algorithm this is $w$ getting a better matching but according to their true preferences $w$ is getting a worse pairing. 
In fact, because the G-S algorithm enables women to have better and better matchings, any $w$ for any set of preferences would be best off staying true to their rankings. 
Switching lesser preferences does not impact the chances of getting their first choice but it runs the risk of $w$ pairing with her worse option rather than a better one as long as 
the worse option is ranked higher. 

}


\newpage
\medskip\noindent{\color{cit} Extra Space for your solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\begin{problem}[30 points]
Suppose you are given two distinct stable matchings $P$ and $Q$ of $n$ hospitals to $n$ students. Construct a new matching $R$ using the following rule:
For each hospital $h$ who is matched to two different students $s$ and $s'$ in $P$ and $Q$, $h$ matches to its preferred student between $s$ and $s'$ in $R.$

\begin{enumerate}
\item Show that $R$ is indeed a matching.
\item Show that $R$ is stable.
\end{enumerate}

\end{problem}
\solution{

\paragraph{Proof to 1} We can prove by contradiction. Let's assume $h$: $s > s'$ since the proof can work vice versa. We assume ($h$, $s$) or ($h$, $s'$) is not a match. However, this contradicts
 the given that ($h$, $s$) exists as a stable match in \textit{P} and ($h$, $s'$) exists as a stable match in \textit{Q}. Since P is a list of stable matchings, we know that there exists a perfect 
 matching between hospitals and students by definiton. As in, every hospital matches with one student only and every student matches with one hospital only: a one-to-one relationship. Thus, as long
 as there exists an $h$ not paired with a student, and students $s$, $s'$ in hospital $h$'s preference list, there exists a match in \textit{R}. 

\paragraph{Proof to 2} We can prove by contradiction. Let's assume either relationship ($h$, $s$), ($h$, $s'$) is not stable. This proof can work for either option but let's work with ($h$, $s$) which is 
in \textit{P}. If ($h$, $s$) in \textit{R} is not stable then there exists some $h'$ in \textit{R} such that $h'$ prefers $s$ to $s'$ and $s$ prefers $h'$ to $h$. This would result in an instability such 
that ($h'$, $s$) is a better match than ($h$, $s$). However, this contradicts the fact that ($h$, $s$) was a stable match in \textit{P}. Since we are given that ($h$, $s$) was stable, we know there does not 
exist an $h'$ such that ($h'$, $s$) is a better match than ($h$, $s$) in \textit{R}. 

}

\newpage
\medskip\noindent{\color{cit} Extra Space for your solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\begin{problem}[15 points]
Complete the following review exercises about big-O notation.

\begin{enumerate}
    \item[(a)] Describe each of the following functions $T:\mathbb{N} \to \mathbb{R}^{+}$ using big O notation. For full credit, the big-O expression should be as simple as possible (to a reasonable observer). Note: For this problem it is sufficient to describe the upper bound for each of these functions. For example, if we had $T(n) = 10000$, we could say that $T(n)$ is $\Theta(1)$ but it is sufficient to say that $T(n)$ is $O(1)$.
    \begin{enumerate}
    \item[1.] $T(n) = 5n \log_2(n)+ 2n + 3$
    \item[2.] $T(n) = 20n + n^2$
    \item[3.] $T(n) = 100 + 2\sqrt{n} + 7 \log_2(n)$
    \item[5.] $T(n) = 10{n^2}\cdot {4^n}$
    \end{enumerate}
    \item[(b)] Prove that for functions $f,g: \mathbb{N} \to \mathbb{R}^{+}$, $f(n)$ is $O(g(n))$ if and only if 
    \[
    \exists n_0, C: \forall n \geq n_0, \log(f(n)) \leq \log(g(n)) + C 
    \]
    \item[(c)] Order the following bounds from smallest to largest: 
    $O(n^2)$, $O(2^n)$, $O(1)$, $O(\log_2(n))$, $O(n\log_2(n))$, $O(\sqrt{n})$, $O(n^{\log_2(n)})$, $O(n)$, $O(n^{\sqrt{n}})$, $O((\log_2(n))^{10})$. [{\bf Hint:} Use part (b)]
    \end{enumerate}
 




\end{problem}



\newpage
\medskip\noindent{\color{cit} Extra Space for your solution}



\end{document}
